{"remainingRequest":"/home/colin/Workspace/src/platone-frontend/node_modules/babel-loader/lib/index.js!/home/colin/Workspace/src/platone-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/colin/Workspace/src/platone-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/colin/Workspace/src/platone-frontend/src/components/page/Contracts.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/colin/Workspace/src/platone-frontend/src/components/page/Contracts.vue","mtime":1601364074454},{"path":"/home/colin/Workspace/src/platone-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/colin/Workspace/src/platone-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/colin/Workspace/src/platone-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/colin/Workspace/src/platone-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.search\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { dataUrl, apiServerUrl } from \"../../config\";\nexport default {\n  data: function data() {\n    return {\n      param: {\n        info: ''\n      },\n      contracts: [],\n      currentPage: 1,\n      PageSize: 10,\n      totalCount: 100,\n      form: {\n        setCNS: false,\n        CNS: \"\"\n      },\n      file: [],\n      dialogFormVisible: false\n    };\n  },\n  methods: {\n    submitForm: function submitForm() {\n      var _this = this;\n\n      this.$refs.search.validate(function (valid) {\n        if (valid) {\n          _this.axios.get(dataUrl + '/contract/' + _this.param.info).then(function (res) {\n            if (res.data && res.data.address) {\n              _this.$router.push('/contract/' + res.data.address);\n            }\n          }).catch(function (res) {\n            return false;\n          });\n        } else {\n          _this.$message.error(_this.$t(\"i18n.searchInfo\"));\n\n          return false;\n        }\n      });\n    },\n    httpRequest: function httpRequest(param) {\n      this.file.push(param.file);\n    },\n    submitDeploy: function submitDeploy() {\n      var _this2 = this;\n\n      this.$refs.upload.submit();\n      var updata = new FormData();\n      this.file.forEach(function (file) {\n        updata.append('file', file, file.name);\n      });\n      updata.append('body', JSON.stringify(this.form));\n      console.log(updata.getAll('file'));\n      console.log(updata.get('body'));\n      this.axios.post(apiServerUrl + '/user/deploycontract', updata, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(function (res) {\n        console.log(res); //set cns\n\n        if (_this2.form.setCNS && _this2.form.CNS != \"\") {\n          var data = res.data.data.replace(/\\\\n/g, '').replace(/\\\\t/g, '');\n          var dataJson = JSON.parse(JSON.parse(data));\n          console.log(dataJson);\n\n          _this2.axios.get(apiServerUrl + '/user/cns/setcnsnameforaddress', {\n            params: {\n              Name: _this2.form.CNS,\n              Version: '0.0.0.1',\n              Address: dataJson.contractAddress\n            }\n          });\n        }\n\n        _this2.$message.success(_this2.$t('i18n.submitSuccess'));\n\n        window.location.reload();\n      }).catch(function (res) {\n        console.log(res);\n      });\n      this.dialogFormVisible = false;\n    },\n    onRowClick: function onRowClick(row, column, event) {\n      alert(row.miner);\n    },\n    getData: function getData() {\n      var _this3 = this;\n\n      this.axios.get(dataUrl + '/contracts', {\n        params: {\n          page_index: this.currentPage,\n          page_size: this.PageSize\n        }\n      }).then(function (res) {\n        _this3.contracts = res.data.items;\n        _this3.totalCount = res.data.total;\n      }).catch(function (res) {\n        console.log(res);\n      });\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.currentPage = val;\n      this.getData();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.PageSize = val;\n      this.getData();\n    }\n  },\n  mounted: function mounted() {\n    this.getData();\n    setInterval(this.getData(), 2000);\n  },\n  computed: {\n    rules: function rules() {\n      return {\n        info: [{\n          required: true,\n          message: this.$t(\"i18n.searchInfo\"),\n          trigger: 'blur'\n        }]\n      };\n    }\n  }\n};",{"version":3,"sources":["Contracts.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n<div>\n    <el-form :model=\"param\" :rules=\"rules\" ref=\"search\" label-width=\"0px\" class=\"ms-content\" @submit.native.prevent>\n        <el-form-item prop=\"info\">\n            <el-input v-model=\"param.info\" placeholder=\"Search by contract address\" @keyup.enter.native=\"submitForm()\">\n                <el-button slot=\"prepend\" icon=\"el-icon-lx-search\"></el-button>\n            </el-input>\n        </el-form-item>\n    </el-form>\n    <div style=\"padding:0px 30px 10px 30px\">\n        <el-card shadow=\"hover\" >\n            <el-button type=\"primary\" round style=\"margin-bottom:10px\" @click=\"dialogFormVisible = true\">{{$t('i18n.deploy')}}</el-button>\n\n            <el-dialog :title=\"$t('i18n.deploy')\" :visible.sync=\"dialogFormVisible\">\n            <el-form :model=\"form\">\n                <el-form-item :label=\"$t('i18n.contractFile')\">\n                    <div style=\"display:inline-block\">\n                         <el-upload\n                            ref=\"upload\"\n                            drag\n                            action=\"\"\n                            multiple\n                            :http-request=\"httpRequest\"\n                            :auto-upload=\"false\">\n                                <i class=\"el-icon-upload\"></i>\n                                <div class=\"el-upload__text\">{{$t('i18n.dragFile')}}<em>{{$t('i18n.clickUpload')}}</em></div>\n                                <div class=\"el-upload__tip\" slot=\"tip\">{{$t('i18n.twoFile')}}</div>\n                        </el-upload>\n                    </div>\n                </el-form-item>\n                 <el-form-item :label=\"$t('i18n.isSetCNS')\">\n                    <el-switch v-model=\"form.setCNS\"></el-switch>\n                    <el-input v-model=\"form.CNS\" placeholder=\"CNS Name\" v-if=\"form.setCNS\"></el-input>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogFormVisible = false\">{{$t('i18n.cancel')}}</el-button>\n                <el-button type=\"primary\" @click=\"submitDeploy\">{{$t('i18n.confirm')}}</el-button>\n            </div>\n            </el-dialog>\n\n            <el-table :data=\"contracts\">\n                <el-table-column :label=\"`${$t('i18n.scName')}`\" :max-width=\"250\" show-overflow-tooltip>\n                    <template slot-scope=\"scope\"><router-link :to = \"'/contract/' + scope.row.address\">{{'(' + scope.row.name + ')' + scope.row.address}}</router-link></template>\n                </el-table-column>\n                <el-table-column :label=\"`Creator`\" show-overflow-tooltip  :max-width=\"250\">\n                    <template slot-scope=\"scope\"><router-link :to = \"'/address/' + scope.row.creator + '/txs'\">{{scope.row.creator}}</router-link></template>\n                </el-table-column>\n                <el-table-column :label=\"`Transaction`\"  show-overflow-tooltip :max-width=\"250\">\n                    <template slot-scope=\"scope\"><router-link :to = \"'/tx/' + scope.row.tx_hash\">{{scope.row.tx_hash}}</router-link></template>\n                </el-table-column>\n                <el-table-column :label=\"`${$t('i18n.time')}`\"  :width=\"150\">\n                    <template slot-scope=\"scope\">\n                        <span>{{(new Date(scope.row.timestamp *1000)).toLocaleString()}}</span>\n                    </template>  \n                </el-table-column>\n                </el-table>\n            <el-pagination  \n                @current-change=\"handleCurrentChange\" \n                @size-change=\"handleSizeChange\"\n                :current-page=\"currentPage\" \n                :page-size=\"PageSize\" layout=\"total, sizes, prev, pager, next, jumper\" \n                :total=\"totalCount\">\n              </el-pagination>\n        </el-card>\n    </div>\n</div>\n    \n</template>\n\n<script>\nimport {dataUrl,apiServerUrl} from '../../config'\nexport default {\n    data: function() {\n        return {\n            param: {\n                info: '',\n            },\n            contracts:[],\n            currentPage:1,\n            PageSize:10,\n            totalCount:100,\n            form: {\n                setCNS:false,\n                CNS:\"\"\n            },\n            file:[],\n            dialogFormVisible: false\n        }\n    },\n    methods: {\n        submitForm() {\n            this.$refs.search.validate(valid => {\n                if (valid) {\n                    this.axios.get(dataUrl + '/contract/' + this.param.info)\n                    .then(res => {\n                        if(res.data && res.data.address){\n                            this.$router.push('/contract/' + res.data.address);\n                        }\n                    }).catch(res => {\n                        return false;\n                    });\n                } else {\n                    this.$message.error(this.$t(\"i18n.searchInfo\"));\n                    return false;\n                }\n            });\n        },\n        httpRequest(param){\n            this.file.push(param.file)\n        },\n\n        submitDeploy(){\n            this.$refs.upload.submit();\n\n            var updata = new FormData();\n            this.file.forEach(function(file){\n                updata.append('file',file,file.name)\n            })\n            updata.append('body',JSON.stringify(this.form))\n            console.log(updata.getAll('file'))\n            console.log(updata.get('body'))\n\n            this.axios.post(apiServerUrl + '/user/deploycontract',updata,{\n                headers:{'Content-Type': 'multipart/form-data' }\n            }).then(res => {\n                console.log(res);\n\n                //set cns\n                if (this.form.setCNS &&this.form.CNS != \"\"){\n\n                    let data = res.data.data.replace(/\\\\n/g,'').replace(/\\\\t/g,'')\n                    let dataJson = JSON.parse(JSON.parse(data))\n                    console.log(dataJson)\n                    this.axios.get(apiServerUrl + '/user/cns/setcnsnameforaddress',{\n                        params: {\n                            Name:this.form.CNS,\n                            Version:'0.0.0.1',\n                            Address:dataJson.contractAddress\n                        }\n                    })\n                }\n                this.$message.success(this.$t('i18n.submitSuccess'));\n                window.location.reload();\n            }).catch(res => {\n                console.log(res);\n            });\n            this.dialogFormVisible = false\n        },\n        onRowClick (row, column, event){\n            alert(row.miner)\n        },\n        getData(){\n            this.axios.get(dataUrl + '/contracts',{\n                    params: {\n                        page_index: this.currentPage,\n                        page_size: this.PageSize\n                    }\n                }).then(res => {\n                this.contracts = res.data.items;\n                this.totalCount = res.data.total;\n            }).catch(res => {\n                console.log(res);\n            });\n        },\n        handleCurrentChange(val){\n            this.currentPage = val;\n            this.getData();\n        },\n        handleSizeChange(val){\n            this.PageSize = val;\n             this.getData();\n        },\n    },\n    mounted:function() {\n        this.getData()\n        setInterval(this.getData(),2000)\n    },    \n    computed:{\n        rules()\n        {\n            return {\n                info: [{ required: true, message: this.$t(\"i18n.searchInfo\"), trigger: 'blur' }]\n            }    \n        },\n    }\n};\n</script>\n\n<style scoped>\n.ms-content {\n    padding: 30px 30px 10px 30px;\n}\n\n.btn{\n    width:100%\n}\n\na{\n    color: #3498db;\n}\n</style>\n\n"],"sourceRoot":"src/components/page"}]}